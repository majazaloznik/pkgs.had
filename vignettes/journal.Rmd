---
title: "Journal"
author: "mz"
date: "`r Sys.Date()`"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Journal}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r setup, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```


# Introduction 

```{r eval = FALSE}
install.packages(c("devtools", "roxygen2", "testthat", "knitr"))
install.packages("digest")
install.packages("rcmdcheck")
devtools::install_github("hadley/devtools")
library("devtools")

x <-  has_devel()
x
```
*In the book it says `has_devel()` will return a bunch of diagnostics and then `TRUE`, but it now seems to return the value silently---invisibly. *




# Package structure

Says it doesn't matter if you start a package from Rstudio or using `devtools::create()` even though Robert Flight says a rstudio created project won't pass the CRAn tests - although he did say that in 2014. 

At this point I start a package as a new project, from Rstudio, also initialising a `git` repo and a `packrat` file. Best see how this works in practice. 

After I do the initial commit I realise I obviously don't have a github repo yet, so I start a new one and then use:

```
git remote add origin git@github.com:majazaloznik/pkgs.had.git
```
to add  the repository.

Then I also start this journal as a vingette, because what else am I gonna write it as? 
```{r eval = FALSE}
devtools::use_vignette("journal")
```

## Package states

### Source package

A source package is the development version of a package that lived on my conmputer: the directory with all the components e.g. `R/`, `DESCRIPTION` etc.

### Bundled package

Is compressed to a single file---by linux convention `tar.gz`. If you decompress a bundle it will look **almost** like a source package. You create a bundle using `devtools::build()`, which will bundle everyhting but what is in the `Rbuildignore` file and temporary files like compilation files in `src/`. Bundles also have the vignettes built to html and pdf. 

`Rbuildignore` lets you have additional files and folders in the source package that are not included in the bundle e.g. data you generated: you want the data in the source package but doens't need to be distributed. 

Use Perl-compatible regular expresions to exclude files. (e.g. `notes` will also exclude `end.notes.R`, so you have to say `^notes$` to be clear that the name begins `^` and ends `$` with notes. 

You can use `devtools::use_build_ignore()` to have it do the regexing for you. 


### Binary package

To distribute to someone without development tools, you need a binary. This is also a single file, but when uncompressed it is slightly different to the source package:

* No .R files in the `R/` directory but `.RData` files instead, three of them, that are basically the functions loaded into R and saved. 
* a `Meta/` directory with a number of `Rds` files, which contains metadata about the package. This is also for faster loading. 
* a `html/` directory with the html help files
* "if you had any code in the `src/` directory there will now be a `libs/` directory that contains the results of compiling 32 bit and 64 bit code."
* the contents of the `inst/` directory are moved to the top level. 

Binary packages are **platform specific**. 

Use `devtools::build(binary = TRUE)` to build a binary---*although it doesnt' say how you bild one specific to each platform?* Oh, seems like it's current platform only?

### Installed package

Is a binary that has been decompressed into a package library. This can be done in several ways. e/g/:

* from CRAN i.e. from a binary file - `install.packages()`
* from github i.e. first downloads a source package, then builds (the bundle) it and then installs it

### In memory packages

To use a package you must load it into memory. There is an important disticntion between loading and loading and attaching an installed package.: 

* `devtools::install()`---loads the devtools package
* `library(devtools); install()` loads and attaches devtools. 

This will apparently be explained later, but for now, library is not useful when you're developing the package, because you have to install it first. 

## What is a library

A library is simply a directory containing packages. Use `.libPaths()` to see what you've got active


# Rcode
